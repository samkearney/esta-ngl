<!--
  An example of physical exclusion as applied to gobo wheels and gobos.

  This device has a gobo wheel with six slots and a single motor that can rotate all of the slots
  at once.

  The gobo wheel is controllable via an angular position, an angular velocity, or an indexed position
  where you select which gobo is displayed by index.

  The gobo wheel also includes an interface-selector property by which one of the above three modes
  can be selected, and a selected-interface property which reads back which interface is currently
  active.

  NOTE: Gobo is not yet defined - need an image solution
-->
<?xml version="1.0" encoding="UTF-8" ?>
<udr>
  <import name="org.esta.device.1" />
  <import name="org.esta.intensity.1" />

  <library class="com.acme.definitions.1" description="ACME General Definitions" publishdate="2020-09-02" author="ACME Corp">
    <!-- Some standard ESTA definitions put here for convenience -->
    <propertydef class="org.esta.core.1/interface-selector" name="Interface Selector" description="Selects an active interface from an exclusive group" data_type="refid" />

    <interfacedef class="org.esta.wheel.1/wheel-velocity" name="Wheel Velocity" description="The speed of a wheel">
      <property class="org.esta.wheel.1/angular-velocity" id="velocity" access="readwrite" lifetime="runtime" />
    </interfacedef>
    <interfacedef class="org.esta.wheel.1/wheel-position-indexed" name="Wheel Position Index" description="The indexed position of a wheel">
      <property class="org.esta.wheel.1/index" id="index" access="readwrite" lifetime="runtime" />
    </interfacedef>
    <interfacedef class="org.esta.wheel.1/wheel-position" name="Wheel Position" description="The angular position of a wheel">
      <property class="org.esta.wheel.1/angular-position" id="position" access="readwrite" lifetime="runtime" minimum="0" maximum="360" />
    </interfacedef>

    <interfacedef class="org.esta.wheel.1/wheel" name="Wheel" description="A wheel">
      <property class="org.esta.core.1/interface-selector" id="wheel-control" modeselector="wheel-control" lifetime="runtime" access="readwrite" />
      <!-- Implied but not actually present
        <property class="org.esta.core.1/selected-interface" id="wheel-mode" lifetime="runtime" access="readonly" />
      -->

      <interfaceconstraint class="org.esta.wheel.1/wheel-velocity" maximum="1" exclusivegroup="wheel-control" />
      <interfaceconstraint class="org.esta.wheel.1/wheel-position-indexed" maximum="1" exclusivegroup="wheel-control" />
      <interfaceconstraint class="org.esta.wheel.1/wheel-position" maximum="1" exclusivegroup="wheel-control" />
      <interfaceconstraint class="org.esta.wheel.1/wheel" maximum="1" />
      <interfaceconstraint class="org.esta.gobo.1/gobo-description" />
    </interfacedef>

  </library>

  <library class="com.acme.devices.1" description="ACME Device Definitions" publishdate="2020-09-02" author="ACME Corp"/>
    <devicedef class="gobo-wheel-5000">
      <interface class="org.esta.device.1/device" id="device">
        <override refid="device-id" attribute="value">com.acme.mydevice.1</override>
        <override refid="device-manufacturer" attribute="value">My Organization</override>
        <override refid="device-model" attribute="value">Gobo Wheel 5000</override>
      </interface>

      <interface class="org.esta.wheel.1/wheel" id="gobo-wheel">
        <interface class="org.esta.wheel.1/wheel-velocity" id="velocity" />
        <interface class="org.esta.wheel.1/wheel-position" id="position" />
        <interface class="org.esta.wheel.1/wheel-position-indexed" id="position-indexed" />

        <interface class="org.esta.wheel.1/wheel" id="gobo-rotator">
          <interface class="org.esta.wheel.1/wheel-velocity" id="velocity" />
          <interface class="org.esta.wheel.1/wheel-position" id="position" />
        </interface>

        <interface class="org.esta.wheel.1/gobo-description" id="1" />
        <interface class="org.esta.wheel.1/gobo-description" id="2" />
        <interface class="org.esta.wheel.1/gobo-description" id="3" />
        <interface class="org.esta.wheel.1/gobo-description" id="4" />
        <interface class="org.esta.wheel.1/gobo-description" id="5" />
        <interface class="org.esta.wheel.1/gobo-description" id="6" />
      </interface>
    </devicedef>
  </library>
</udr>

